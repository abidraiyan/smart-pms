
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Book Appointment</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
<div class="container">
  <h1>Appointment Booking</h1>
  <a href="index.html">‚Üê Back</a>
  <div class="grid">
    <div class="card">
      <label>Patient Email</label>
      <input id="patient_email" placeholder="jane@example.com">
      <label>Date</label>
      <input id="date" type="date">
      <label>Time</label>
      <input id="time" type="time">
      <label>Doctor</label>
      <select id="doctor">
        <option>Dr. Smith</option>
        <option>Dr. Lee</option>
        <option>Dr. Patel</option>
      </select>
      <button class="secondary" onclick="book()">Book</button>
      <p id="msg"></p>
      <small class="mono">POST /book</small>
    </div>
    <div class="card">
      <h3>Appointments</h3>
      <table id="appointments"><thead><tr><th>Patient</th><th>Email</th><th>Date</th><th>Time</th><th>Doctor</th></tr></thead><tbody></tbody></table>
    </div>
  </div>
</div>
<script>
const API="http://localhost:5000";
async function book(){
  const msg=document.getElementById('msg'); msg.textContent=""; msg.className="";
  const payload={
    patient_email: document.getElementById('patient_email').value.trim(),
    date: document.getElementById('date').value,
    time: document.getElementById('time').value,
    doctor: document.getElementById('doctor').value
  };
  const res = await fetch(API+"/book",{method:"POST", headers:{"Content-Type":"application/json"}, body:JSON.stringify(payload)});
  const data = await res.json();
  if(res.ok){ msg.textContent="Booked for "+data.appointment.patient_name; msg.className="ok"; loadAppointments(); }
  else { msg.textContent=data.error||"Error"; msg.className="err"; }
}
async function loadAppointments(){
  const res = await fetch(API+"/appointments");
  const data = await res.json();
  const tbody=document.querySelector('#appointments tbody'); tbody.innerHTML="";
  data.forEach(a=>{
    const tr=document.createElement('tr');
    tr.innerHTML=`<td>${a.patient_name||"-"}</td><td>${a.patient_email}</td><td>${a.date}</td><td>${a.time}</td><td>${a.doctor}</td>`;
    tbody.appendChild(tr);
  });
}
loadAppointments();
</script>
</body>
</html>
